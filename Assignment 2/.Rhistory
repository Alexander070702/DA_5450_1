# Load the caret package for data partitioning
library("caret")
# Load the churn dataset from a URL and convert the churn variable to binary
churndat <- read.csv(url("https://statmath.wu.ac.at/~malsiner/datasets/churn.csv"))
churndat$churn <- ifelse(churndat$churn == "Yes", 1, 0)
# Convert the internationalplan and voicemailplan variables to binary
churndat$internationalplan <- ifelse(churndat$internationalplan == "yes", 1, 0)
churndat$voicemailplan <- ifelse(churndat$voicemailplan == "yes", 1, 0)
#structure of the data
str(churndata)
#structure of the data
str(churndat)
# Split the data into training and testing sets, with 80% for training and 20% for testing
set.seed(123) # for reproducibility
# Load the caret package for data partitioning
library("caret")
# Load the churn dataset from a URL and convert the churn variable to binary
churndat <- read.csv(url("https://statmath.wu.ac.at/~malsiner/datasets/churn.csv"))
churndat$churn <- ifelse(churndat$churn == "Yes", 1, 0)
# Convert the internationalplan and voicemailplan variables to binary
churndat$internationalplan <- ifelse(churndat$internationalplan == "yes", 1, 0)
churndat$voicemailplan <- ifelse(churndat$voicemailplan == "yes", 1, 0)
#structure of the data
str(churndat)
# Generate bar plots for all variables differentiated into churn vs. no churn
ggplot(churndat, aes(x = churn, fill = factor(state))) +
geom_bar(position = "dodge") +
labs(title = "Churn vs. No Churn by State")
# Load the caret package for data partitioning
library("caret")
# Load the churn dataset from a URL and convert the churn variable to binary
churndat <- read.csv(url("https://statmath.wu.ac.at/~malsiner/datasets/churn.csv"))
churndat$churn <- ifelse(churndat$churn == "Yes", 1, 0)
# Convert the internationalplan and voicemailplan variables to binary
churndat$internationalplan <- ifelse(churndat$internationalplan == "yes", 1, 0)
churndat$voicemailplan <- ifelse(churndat$voicemailplan == "yes", 1, 0)
#structure of the data
str(churndat)
# Generate bar plots for all variables differentiated into churn vs. no churn
for (col in names(churndat)){
if (col != "state" && col != "area_code" && col != "phone_number" && col != "churn") {
plot_data <- churndat %>%
group_by(churn, !!sym(col)) %>%
summarise(n = n()) %>%
mutate(prop = n/sum(n)) %>%
ungroup()
ggplot(data = plot_data, aes(x = !!sym(col), y = prop, fill = as.factor(churn))) +
geom_col(position = "dodge") +
labs(title = paste("Churn by", col), x = col, y = "Proportion", fill = "Churn") +
theme_minimal() +
scale_fill_manual(values = c("#00BFC4", "#F8766D"))
}
}
# Load the caret package for data partitioning
library("caret")
library(tidyverse)
# Load the churn dataset from a URL and convert the churn variable to binary
churndat <- read.csv(url("https://statmath.wu.ac.at/~malsiner/datasets/churn.csv"))
churndat$churn <- ifelse(churndat$churn == "Yes", 1, 0)
# Convert the internationalplan and voicemailplan variables to binary
churndat$internationalplan <- ifelse(churndat$internationalplan == "yes", 1, 0)
churndat$voicemailplan <- ifelse(churndat$voicemailplan == "yes", 1, 0)
#structure of the data
str(churndat)
# Generate bar plots for all variables differentiated into churn vs. no churn
for (col in names(churndat)){
if (col != "state" && col != "area_code" && col != "phone_number" && col != "churn") {
plot_data <- churndat %>%
group_by(churn, !!sym(col)) %>%
summarise(n = n()) %>%
mutate(prop = n/sum(n)) %>%
ungroup()
ggplot(data = plot_data, aes(x = !!sym(col), y = prop, fill = as.factor(churn))) +
geom_col(position = "dodge") +
labs(title = paste("Churn by", col), x = col, y = "Proportion", fill = "Churn") +
theme_minimal() +
scale_fill_manual(values = c("#00BFC4", "#F8766D"))
}
}
# Load the caret package for data partitioning
library("caret")
library(tidyverse)
# Load the churn dataset from a URL and convert the churn variable to binary
churndat <- read.csv(url("https://statmath.wu.ac.at/~malsiner/datasets/churn.csv"))
churndat$churn <- ifelse(churndat$churn == "Yes", 1, 0)
# Convert the internationalplan and voicemailplan variables to binary
churndat$internationalplan <- ifelse(churndat$internationalplan == "yes", 1, 0)
churndat$voicemailplan <- ifelse(churndat$voicemailplan == "yes", 1, 0)
#structure of the data
str(churndat)
# Generate bar plots for all variables differentiated into churn vs. no churn
for (col in names(churndat)){
if (col != "state" && col != "area_code" && col != "phone_number" && col != "churn") {
plot_data <- churndat %>%
group_by(churn, !!sym(col)) %>%
summarise(n = n()) %>%
mutate(prop = n/sum(n)) %>%
ungroup()
ggplot(data = plot_data, aes(x = !!sym(col), y = prop, fill = as.factor(churn))) +
geom_col(position = "dodge") +
labs(title = paste("Churn by", col), x = col, y = "Proportion", fill = "Churn") +
theme_minimal() +
scale_fill_manual(values = c("#00BFC4", "#F8766D"))
}
}
# Load the caret package for data partitioning
library("caret")
library(tidyverse)
library(ggplot2)
# Load the churn dataset from a URL and convert the churn variable to binary
churndat <- read.csv(url("https://statmath.wu.ac.at/~malsiner/datasets/churn.csv"))
churndat$churn <- ifelse(churndat$churn == "Yes", 1, 0)
# Convert the internationalplan and voicemailplan variables to binary
churndat$internationalplan <- ifelse(churndat$internationalplan == "yes", 1, 0)
churndat$voicemailplan <- ifelse(churndat$voicemailplan == "yes", 1, 0)
#structure of the data
str(churndat)
# Create bar plots for all variables differentiated into churn vs. no churn
for (col in names(churndat)){
if (col != "state" && col != "area_code" && col != "phone_number" && col != "churn") {
plot_data <- churndat %>%
group_by(churn, !!sym(col)) %>%
summarise(n = n()) %>%
mutate(prop = n/sum(n)) %>%
ungroup()
print(ggplot(data = plot_data, aes(x = !!sym(col), y = prop, fill = as.factor(churn))) +
geom_col(position = "dodge") +
labs(title = paste("Churn by", col), x = col, y = "Proportion", fill = "Churn") +
theme_minimal() +
scale_fill_manual(values = c("#00BFC4", "#F8766D")))
}
}
# Split the data into training and testing sets, with 80% for training and 20% for testing
set.seed(123) # for reproducibility
train_index <- createDataPartition(churndat$churn, p = 0.8, list = FALSE)
#structure of the data
str(churndat)
# Create bar plots for all variables differentiated into churn vs. no churn
# Create bar plots for all variables differentiated into churn vs. no churn
for (col in names(churndat)){
if (col != "state" && col != "area_code" && col != "phone_number") {
plot_data <- churndat %>%
group_by(churn, !!sym(col)) %>%
summarise(n = n()) %>%
mutate(prop = n/sum(n)) %>%
ungroup()
if (is.numeric(churndat[[col]])) {
print(ggplot(data = plot_data, aes(x = !!sym(col), y = prop, fill = as.factor(churn))) +
geom_col(position = "dodge") +
labs(title = paste("Churn by", col), x = col, y = "Proportion", fill = "Churn") +
theme_minimal() +
scale_fill_manual(values = c("#00BFC4", "#F8766D")))
} else {
print(ggplot(data = plot_data, aes(x = !!sym(col), y = prop, fill = as.factor(churn))) +
geom_col(position = "dodge") +
labs(title = paste("Churn by", col), x = col, y = "Proportion", fill = "Churn") +
theme_minimal() +
scale_fill_manual(values = c("#00BFC4", "#F8766D")) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)))
}
}
}
# Create bar plots for all variables differentiated into churn vs. no churn
# Create bar plots for all variables differentiated into churn vs. no churn
for (col in names(churndat)){
if (col != "state" && col != "area_code" && col != "phone_number") {
plot_data <- churndat %>%
group_by(churn, !!sym(col)) %>%
summarise(n = n()) %>%
mutate(prop = n/sum(n)) %>%
ungroup()
if (is.numeric(churndat[[col]])) {
print(ggplot(data = plot_data, aes(x = !!sym(col), y = prop, fill = as.factor(churn))) +
geom_col(position = "dodge") +
labs(title = paste("Churn by", col), x = col, y = "Proportion", fill = "Churn") +
theme_minimal() +
scale_fill_manual(values = c("#00BFC4", "#F8766D")))
} else {
print(ggplot(data = plot_data, aes(x = !!sym(col), y = prop, fill = as.factor(churn))) +
geom_col(position = "dodge") +
labs(title = paste("Churn by", col), x = col, y = "Proportion", fill = "Churn") +
theme_minimal() +
scale_fill_manual(values = c("#00BFC4", "#F8766D")) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)))
}
}
}
# Split the data into training and testing sets, with 80% for training and 20% for testing
set.seed(123) # for reproducibility
# Load the caret package for data partitioning
library("caret")
library(tidyverse)
library(ggplot2)
# Load the churn dataset from a URL and convert the churn variable to binary
churndat <- read.csv(url("https://statmath.wu.ac.at/~malsiner/datasets/churn.csv"))
churndat$churn <- ifelse(churndat$churn == "Yes", 1, 0)
# Convert the internationalplan and voicemailplan variables to binary
churndat$internationalplan <- ifelse(churndat$internationalplan == "yes", 1, 0)
churndat$voicemailplan <- ifelse(churndat$voicemailplan == "yes", 1, 0)
#structure of the data
str(churndat)
# Create bar plots for all variables differentiated into churn vs. no churn
# Create bar plots for all variables differentiated into churn vs. no churn
for (col in names(churndat)){
if (col != "state" && col != "area_code" && col != "phone_number") {
plot_data <- churndat %>%
group_by(churn, !!sym(col)) %>%
summarise(n = n()) %>%
mutate(prop = n/sum(n)) %>%
ungroup()
if (is.numeric(churndat[[col]])) {
print(ggplot(data = plot_data, aes(x = !!sym(col), y = prop, fill = as.factor(churn))) +
geom_col(position = "dodge") +
labs(title = paste("Churn by", col), x = col, y = "Proportion", fill = "Churn") +
theme_minimal() +
scale_fill_manual(values = c("#00BFC4", "#F8766D")))
} else {
print(ggplot(data = plot_data, aes(x = !!sym(col), y = prop, fill = as.factor(churn))) +
geom_col(position = "dodge") +
labs(title = paste("Churn by", col), x = col, y = "Proportion", fill = "Churn") +
theme_minimal() +
scale_fill_manual(values = c("#00BFC4", "#F8766D")) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)))
}
}
}
# Load the caret package for data partitioning
library("caret")
library(tidyverse)
library(ggplot2)
# Load the churn dataset from a URL and convert the churn variable to binary
churndat <- read.csv(url("https://statmath.wu.ac.at/~malsiner/datasets/churn.csv"))
churndat$churn <- ifelse(churndat$churn == "Yes", 1, 0)
# Convert the internationalplan and voicemailplan variables to binary
churndat$internationalplan <- ifelse(churndat$internationalplan == "yes", 1, 0)
churndat$voicemailplan <- ifelse(churndat$voicemailplan == "yes", 1, 0)
#structure of the data
str(churndat)
# Create bar plots for all variables differentiated into churn vs. no churn
# Create bar plots for all variables differentiated into churn vs. no churn
# Create bar plots for all variables differentiated into churn vs. no churn
for (col in names(churndat)){
if (col != "state" && col != "area_code" && col != "phone_number") {
plot_data <- churndat %>%
group_by(!!sym(col), churn) %>%
summarise(n = n()) %>%
mutate(prop = n/sum(n)) %>%
ungroup()
if (is.numeric(churndat[[col]])) {
print(ggplot(data = plot_data, aes(x = !!sym(col), y = prop, fill = as.factor(churn))) +
geom_col(position = "dodge") +
labs(title = paste("Churn by", col), x = col, y = "Proportion", fill = "Churn") +
theme_minimal() +
scale_fill_manual(values = c("#00BFC4", "#F8766D")))
} else {
print(ggplot(data = plot_data, aes(x = !!sym(col), y = prop, fill = as.factor(churn))) +
geom_col(position = "dodge") +
labs(title = paste("Churn by", col), x = col, y = "Proportion", fill = "Churn") +
theme_minimal() +
scale_fill_manual(values = c("#00BFC4", "#F8766D")) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)))
}
}
}
source("~/Desktop/DA_5450_1/Assignment 2/Assignment_2.R")
# Load the caret package for data partitioning
library("caret")
library(tidyverse)
library(ggplot2)
# Load the churn dataset from a URL and convert the churn variable to binary
churndat <- read.csv(url("https://statmath.wu.ac.at/~malsiner/datasets/churn.csv"))
churndat$churn <- ifelse(churndat$churn == "Yes", 1, 0)
# Convert the internationalplan and voicemailplan variables to binary
churndat$internationalplan <- ifelse(churndat$internationalplan == "yes", 1, 0)
churndat$voicemailplan <- ifelse(churndat$voicemailplan == "yes", 1, 0)
#structure of the data
str(churndat)
# Create bar plots for all variables differentiated into churn vs. no churn
# Create bar plots for all variables differentiated into churn vs. no churn
# Create bar plots for all variables differentiated into churn vs. no churn
for (col in names(churndat)){
if (col != "state" && col != "area_code" && col != "phone_number") {
plot_data <- churndat %>%
group_by(!!sym(col), churn) %>%
summarise(n = n()) %>%
mutate(prop = n/sum(n)) %>%
ungroup()
if (is.numeric(churndat[[col]])) {
print(ggplot(data = plot_data, aes(x = !!sym(col), y = prop, fill = as.factor(churn))) +
geom_col(position = "dodge") +
labs(title = paste("Churn by", col), x = col, y = "Proportion", fill = "Churn") +
theme_minimal() +
scale_fill_manual(values = c("#00BFC4", "#F8766D")))
} else {
print(ggplot(data = plot_data, aes(x = !!sym(col), y = prop, fill = as.factor(churn))) +
geom_col(position = "dodge") +
labs(title = paste("Churn by", col), x = col, y = "Proportion", fill = "Churn") +
theme_minimal() +
scale_fill_manual(values = c("#00BFC4", "#F8766D")) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)))
}
}
}
# Split the data into training and testing sets, with 80% for training and 20% for testing
set.seed(123) # for reproducibility
# Create bar plots for all variables differentiated into churn vs. no churn
for (col in names(churndat)) {
if (col != "state" && col != "area_code" && col != "phone_number") {
plot_data <- churndat %>%
group_by(churn, !!sym(col)) %>%
summarise(n = n())
if (class(plot_data[[2]]) == "character") {
plot <- ggplot(plot_data, aes(x = !!sym(col), y = n, fill = factor(churn))) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = col, x = col, y = "Frequency") +
theme(legend.title = element_blank(), legend.position = "bottom")
} else {
plot <- ggplot(plot_data, aes(x = factor(churn), y = n, fill = !!sym(col))) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = col, x = "Churn", y = "Frequency") +
theme(legend.title = element_blank(), legend.position = "bottom")
}
print(plot)
}
}
# Create bar plots for all variables differentiated into churn vs. no churn
# Create plots for all variables differentiated into churn vs. no churn
for (col in names(churndat)) {
if (col != "state" && col != "area_code" && col != "phone_number") {
plot_data <- churndat %>%
group_by(churn, !!sym(col)) %>%
summarise(n = n()) %>%
ungroup()
if (class(plot_data[[2]]) == "character") {
plot <- ggplot(plot_data, aes(x = !!sym(col), y = n, fill = factor(churn))) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = col, x = col, y = "Frequency") +
theme(legend.title = element_blank(), legend.position = "bottom")
} else {
plot <- ggplot(plot_data, aes(x = factor(churn), y = n, fill = !!sym(col))) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = col, x = "Churn", y = "Frequency") +
theme(legend.title = element_blank(), legend.position = "bottom")
}
print(plot)
}
}
# Load the caret package for data partitioning
library("caret")
library(tidyverse)
library(ggplot2)
# Load the churn dataset from a URL and convert the churn variable to binary
churndat <- read.csv(url("https://statmath.wu.ac.at/~malsiner/datasets/churn.csv"))
churndat$churn <- ifelse(churndat$churn == "Yes", 1, 0)
# Convert the internationalplan and voicemailplan variables to binary
churndat$internationalplan <- ifelse(churndat$internationalplan == "yes", 1, 0)
churndat$voicemailplan <- ifelse(churndat$voicemailplan == "yes", 1, 0)
#structure of the data
str(churndat)
# Create bar plots for all variables differentiated into churn vs. no churn
# Create plots for all variables differentiated into churn vs. no churn
for (col in names(churndat)) {
if (col != "state" && col != "area_code" && col != "phone_number") {
plot_data <- churndat %>%
group_by(churn, !!sym(col)) %>%
summarise(n = n()) %>%
ungroup()
if (class(plot_data[[2]]) == "character") {
plot <- ggplot(plot_data, aes(x = !!sym(col), y = n, fill = factor(churn))) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = col, x = col, y = "Frequency") +
theme(legend.title = element_blank(), legend.position = "bottom")
} else {
plot <- ggplot(plot_data, aes(x = factor(churn), y = n, fill = !!sym(col))) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = col, x = "Churn", y = "Frequency") +
theme(legend.title = element_blank(), legend.position = "bottom")
}
print(plot)
}
}
# Load the caret package for data partitioning
library("caret")
library(tidyverse)
library(ggplot2)
# Load the churn dataset from a URL and convert the churn variable to binary
churndat <- read.csv(url("https://statmath.wu.ac.at/~malsiner/datasets/churn.csv"))
churndat$churn <- ifelse(churndat$churn == "Yes", 1, 0)
# Convert the internationalplan and voicemailplan variables to binary
churndat$internationalplan <- ifelse(churndat$internationalplan == "yes", 1, 0)
churndat$voicemailplan <- ifelse(churndat$voicemailplan == "yes", 1, 0)
#structure of the data
str(churndat)
# Load the caret package for data partitioning
library("caret")
library(tidyverse)
library(ggplot2)
# Load the churn dataset from a URL and convert the churn variable to binary
churndat <- read.csv(url("https://statmath.wu.ac.at/~malsiner/datasets/churn.csv"))
churndat$churn <- ifelse(churndat$churn == "Yes", 1, 0)
# Convert the internationalplan and voicemailplan variables to binary
churndat$internationalplan <- ifelse(churndat$internationalplan == "yes", 1, 0)
churndat$voicemailplan <- ifelse(churndat$voicemailplan == "yes", 1, 0)
#structure of the data
str(churndat)
# Create bar plots for all variables differentiated into churn vs. no churn
# Define a function to create the appropriate plot for each variable
plot_variable <- function(var) {
# Create a bar plot for categorical variables
if (is.factor(var) | is.logical(var)) {
ggplot(churndat, aes(x=churn, fill=var)) +
geom_bar(position="dodge") +
labs(x="Churn", y="Count")
}
# Create a histogram for numerical variables
else {
ggplot(churndat, aes(x=var, fill=churn)) +
geom_histogram(position="dodge", alpha=0.5, bins=10) +
labs(x=names(churndat[var]), y="Count")
}
}
# Loop through each variable and generate a plot
for (col in names(churndat)[-1]) {
print(plot_variable(churndat[,col]))
}
# Load the caret package for data partitioning
library("caret")
library(tidyverse)
library(ggplot2)
# Load the churn dataset from a URL and convert the churn variable to binary
churndat <- read.csv(url("https://statmath.wu.ac.at/~malsiner/datasets/churn.csv"))
churndat$churn <- ifelse(churndat$churn == "Yes", 1, 0)
# Convert the internationalplan and voicemailplan variables to binary
churndat$internationalplan <- ifelse(churndat$internationalplan == "yes", 1, 0)
churndat$voicemailplan <- ifelse(churndat$voicemailplan == "yes", 1, 0)
#structure of the data
str(churndat)
# Create bar plots for all variables differentiated into churn vs. no churn
# Define a function to plot appropriate graphs for each variable
plot_churn_var <- function(var) {
# Group the data by churn and variable
churndat %>%
group_by(churn, !!sym(var)) %>%
summarise(n = n()) %>%
ungroup() %>%
# Plot a graph based on the variable type
ggplot(aes(x = !!sym(var), y = n, fill = as.factor(churn))) +
geom_bar(stat = "identity", position = "dodge") +
labs(x = var, y = "Count", fill = "Churn") +
theme_bw()
}
# Plot graphs for all variables
churn_vars <- names(churndat)[-1]  # Exclude churn variable
plots_list <- lapply(churn_vars, plot_churn_var)
# View the plots
plots_list
# Split the data into training and testing sets, with 80% for training and 20% for testing
set.seed(123) # for reproducibility
#structure of the data
str(churndat)
# Create bar plots for all variables differentiated into churn vs. no churn
# Loop through all variables and generate appropriate plots
for (var in names(churndat)[-1]) {
ggplot(churndat, aes(x = churn, y = !!sym(var), fill = factor(churn))) +
geom_boxplot() +
ggtitle(paste("Churn vs", var)) +
xlab("Churn") +
ylab(var) +
theme(plot.title = element_text(hjust = 0.5))
}
# Split the data into training and testing sets, with 80% for training and 20% for testing
set.seed(123) # for reproducibility
# Load the caret package for data partitioning
library("caret")
library(tidyverse)
library(ggplot2)
# Load the churn dataset from a URL and convert the churn variable to binary
churndat <- read.csv(url("https://statmath.wu.ac.at/~malsiner/datasets/churn.csv"))
churndat$churn <- ifelse(churndat$churn == "Yes", 1, 0)
# Convert the internationalplan and voicemailplan variables to binary
churndat$internationalplan <- ifelse(churndat$internationalplan == "yes", 1, 0)
churndat$voicemailplan <- ifelse(churndat$voicemailplan == "yes", 1, 0)
#structure of the data
str(churndat)
# Create bar plots for all variables differentiated into churn vs. no churn
# Loop through all variables and generate appropriate plots
for (var in names(churndat)[-1]) {
ggplot(churndat, aes(x = churn, y = !!sym(var), fill = factor(churn))) +
geom_boxplot() +
ggtitle(paste("Churn vs", var)) +
xlab("Churn") +
ylab(var) +
theme(plot.title = element_text(hjust = 0.5))
}
# Create bar plots for all variables differentiated into churn vs. no churn
# Loop through all variables and generate appropriate plots
for (var in names(churndat)[-1]) {
ggplot(churndat, aes(x = churn, y = !!sym(var), fill = factor(churn))) +
geom_boxplot() +
ggtitle(paste("Churn vs", var)) +
xlab("Churn") +
ylab(var) +
theme(plot.title = element_text(hjust = 0.5))
print(plot)
}
source("~/Desktop/DA_5450_1/Assignment 2/Assignment_2.R")
